import { Steps, Callout } from 'nextra/components'

# Module 3 - ä»»åŠ¡åˆ—è¡¨

## å•äººéƒ¨åˆ† (Individual Tasks)

<Steps>
### ç¬¬ä¸€æ­¥ï¼šå®‰è£… MySQL å’Œ phpMyAdmin

- åœ¨ EC2 å®ä¾‹ä¸Š [å®‰è£…](https://classes.engineering.wustl.edu/cse330/index.php?title=Introduction_to_MySQL#Managing_Databases) MySQL å’Œ phpMyAdminï¼Œè·Ÿç€è€å¸ˆçš„æ­¥éª¤èµ°å®Œã€‚

### ç¬¬äºŒæ­¥ï¼šè®¾ç½®æ•°æ®åº“

- åˆ›å»ºä¸€ä¸ªåä¸º `wustl` çš„æ•°æ®åº“ã€‚

```sql copy
CREATE DATABASE wustl;
```

- åˆ›å»ºä¸€ä¸ªåä¸º `wustl_inst` çš„ç”¨æˆ·ï¼Œå¯†ç ä¸º `wustl_pass`ã€‚å¹¶ä¸”åˆ·æ–°æƒé™è¡¨ä»¥ç¡®ä¿æ‰€æœ‰æ›´æ”¹ç”Ÿæ•ˆ

```sql copy
CREATE USER 'wustl_inst'@'localhost' IDENTIFIED BY 'wustl_pass';
GRANT ALL PRIVILEGES ON wustl.* TO 'wustl_inst'@'localhost';
FLUSH PRIVILEGES;
```

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºè¡¨

<Callout type="warning">
  ä½¿ç”¨ InnoDB å­˜å‚¨å¼•æ“åˆ›å»ºæ‰€æœ‰è¡¨ï¼Œä»¥æ”¯æŒå¤–é”®çº¦æŸã€‚å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨ `ALTER TABLE` æ›´æ”¹å­˜å‚¨å¼•æ“ã€‚é€‚å½“æ—¶å®šä¹‰å­—æ®µä¸º `NOT NULL` ä»¥é¿å…æ’å…¥ä¸å®Œæ•´çš„æ•°æ®ã€‚
</Callout>

- è¯·é˜…è¯» [MySQL Schema and State](https://classes.engineering.wustl.edu/cse330/index.php?title=MySQL_Schema_and_State) è¿™ä¸€èŠ‚ï¼Œå­¦ä¹ æ‰€æœ‰sqlè¯­å¥ã€‚æˆ‘ä¼šæä¾›æ‰€æœ‰çš„sqlè¯­å¥ï¼Œä½†æ˜¯è¯·ä¸è¦ç›´æ¥å¤åˆ¶ç²˜è´´ï¼Œå…ˆè‡ªå·±å†™å†™çœ‹ã€‚

<Callout>
  å½“ä½ æœ‰äº†myphpadminåªæœ‰å¯ä»¥ç›´æ¥åœ¨è¿™é‡Œè·‘sqlè¯­å¥ï¼ä¸ç”¨å†å»ç»ˆç«¯è·‘sqlè¯­å¥å•¦ yay~

  ![sqlè¯­å¥](/module3/sql.png)

  ç‚¹å‡»ä¸Šæ–¹çš„sql æŠŠè‡ªå·±çš„sqlè¯­å¥æ”¾è¿›å»ç‚¹ `Go` å°±å¯ä»¥è¿è¡Œäº†ï¼Œä¸‹æ–¹å°±å¯ä»¥çœ‹åˆ°è¿è¡Œç»“æœï¼Œè¯·æ³¨æ„è¿™é‡Œç‚¹äº† `Go` ä¹‹åæ˜¯çœŸçš„ä¼šå½±å“ä½ çš„æ•°æ®åº“æ— è®ºæ˜¯æ’å…¥è¿˜æ˜¯åˆ é™¤ä¿®æ”¹æ“ä½œéƒ½æ˜¯ä¼šç”Ÿæ•ˆçš„ï¼Œè¯·è°¨æ…ä½¿ç”¨!!!
</Callout>
#### `students` è¡¨

åˆ›å»ºä¸€ä¸ªåä¸º `students` çš„è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

- `id`ï¼šé€‚å½“å¤§å°çš„æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼ˆä¾‹å¦‚ `INT UNSIGNED`ï¼‰ã€‚
- `first_name`ï¼šç±»å‹ä¸º `VARCHAR(50)`ã€‚
- `last_name`ï¼šç±»å‹ä¸º `VARCHAR(50)`ã€‚
- `email_address`ï¼šç±»å‹ä¸º `VARCHAR(50)`ã€‚

ä¸»é”®åº”ä¸º `id` å­—æ®µã€‚

```sql
CREATE TABLE students (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email_address VARCHAR(50) NOT NULL
) ENGINE=InnoDB;
```

#### `departments` è¡¨

åˆ›å»ºä¸€ä¸ªåä¸º `departments` çš„è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

- `school_code`ï¼šç±»å‹ä¸º `ENUM('L', 'B', 'A', 'F', 'E', 'T', 'I', 'W', 'S', 'U', 'M')`ã€‚
- `dept_id`ï¼šé€‚å½“å¤§å°çš„æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼ˆä¾‹å¦‚ `INT UNSIGNED`ï¼‰ã€‚
- `abbreviation`ï¼šç±»å‹ä¸º `VARCHAR(9)`ã€‚
- `dept_name`ï¼šç±»å‹ä¸º `VARCHAR(200)`ã€‚

ä¸»é”®åº”ä¸º `school_code` å’Œ `dept_id` å­—æ®µã€‚

```sql
CREATE TABLE departments (
    school_code ENUM('L', 'B', 'A', 'F', 'E', 'T', 'I', 'W', 'S', 'U', 'M') NOT NULL,
    dept_id INT UNSIGNED NOT NULL,
    abbreviation VARCHAR(9) NOT NULL,
    dept_name VARCHAR(200) NOT NULL,
    PRIMARY KEY (school_code, dept_id)
) ENGINE=InnoDB;
```

#### `courses` è¡¨

åˆ›å»ºä¸€ä¸ªåä¸º `courses` çš„è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

- `school_code`ï¼šç±»å‹ä¸º `ENUM`ï¼ˆä¸ `departments` è¡¨ä¸­çš„ `school_code` ENUM ç›¸åŒ¹é…ï¼‰ã€‚
- `dept_id`ï¼šä¸ `departments` è¡¨ä¸­ç›¸åŒçš„æ•´æ•°ç±»å‹ã€‚
- `course_code`ï¼šç±»å‹ä¸º `CHAR(5)`ã€‚
- `name`ï¼šç±»å‹ä¸º `VARCHAR(150)`ã€‚

ç¡®ä¿é€‚å½“å­—æ®µå¼•ç”¨ `departments` è¡¨çš„å¤–é”®ã€‚é€‰æ‹©åˆé€‚çš„å­—æ®µä½œä¸ºä¸»é”®ã€‚

```sql
CREATE TABLE courses (
    school_code ENUM('L', 'B', 'A', 'F', 'E', 'T', 'I', 'W', 'S', 'U', 'M') NOT NULL,
    dept_id INT UNSIGNED NOT NULL,
    course_code CHAR(5) NOT NULL,
    name VARCHAR(150) NOT NULL,
    PRIMARY KEY (school_code, dept_id, course_code),
    FOREIGN KEY (school_code, dept_id) REFERENCES departments(school_code, dept_id) ON DELETE CASCADE
) ENGINE=InnoDB;
```

#### `grades` è¡¨

åˆ›å»ºä¸€ä¸ªåä¸º `grades` çš„è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

- `pk_grade_ID`ï¼šé€‚å½“å¤§å°çš„æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼ˆä¾‹å¦‚ `BIGINT UNSIGNED`ï¼‰ï¼Œè®¾ç½®ä¸º `AUTO_INCREMENT` å¹¶ä½œä¸ºä¸»é”®ã€‚
- `student_id`ï¼šä¸ `students` è¡¨ä¸­ç›¸åŒçš„æ•´æ•°ç±»å‹ã€‚
- `grade`ï¼šç±»å‹ä¸º `DECIMAL(5,2)`ã€‚
- `school_code`ï¼šç±»å‹ä¸º `ENUM`ã€‚
- `dept_id`ï¼šä¸å…¶ä»–è¡¨ä¸­ç›¸åŒçš„æ•´æ•°ç±»å‹ã€‚
- `course_code`ï¼šä¸ `courses` è¡¨ä¸­ç›¸åŒçš„ç±»å‹ã€‚

å°†å¤–é”®æ·»åŠ åˆ° `students` è¡¨å’Œ `courses` è¡¨ã€‚

```sql
CREATE TABLE grades (
    pk_grade_ID BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    student_id INT UNSIGNED NOT NULL,
    grade DECIMAL(5,2) NOT NULL,
    school_code ENUM('L', 'B', 'A', 'F', 'E', 'T', 'I', 'W', 'S', 'U', 'M') NOT NULL,
    dept_id INT UNSIGNED NOT NULL,
    course_code CHAR(5) NOT NULL,
    FOREIGN KEY (student_id) REFERENCES students(id) ON DELETE CASCADE,
    FOREIGN KEY (school_code, dept_id, course_code) REFERENCES courses(school_code, dept_id, course_code) ON DELETE CASCADE
) ENGINE=InnoDB;
```

<Callout type="info">
  è®°å¾—æ¯ä¸€ä¸ªè¡¨ä½¿ç”¨ä¸€æ¬¡

  ```sql copy
  SHOW CREATE TABLENAME
  ```

  å¹¶ä¸”æŠŠä½ çš„è¡¨ç»“æ„ä¿å­˜ä¸º `tablename.sql` æ–‡ä»¶ï¼Œæ”¾è¿›ä½ çš„GitHubä»“åº“ä»¥ä¾¿è€å¸ˆæ£€æŸ¥
</Callout>

### ç¬¬å››æ­¥ï¼šå¯¼å…¥æ•°æ®

- ä»ä»¥ä¸‹æ–‡ä»¶ä¸‹è½½å¹¶å°†æ•°æ®åŠ è½½åˆ°è¡¨ä¸­ï¼š

<Callout>
  è¿™é‡Œå»ºè®®ä½¿ç”¨æˆ‘æä¾›çš„æ–‡ä»¶ï¼Œæ”¯æŒ myphpadmin ä¸€é”®å¯¼å…¥ï¼Œè€å¸ˆçš„æä¾›çš„éœ€è¦ä½ è‡ªå·±è°ƒæ•´ä»æœåŠ¡å™¨ä¸Šå¯¼å…¥ã€‚è¿™é‡Œæ‰“å¼€æˆ‘å‡†å¤‡çš„æ–‡ä»¶åå³é”®ä¿å­˜ä¸º txt å³å¯ã€‚
</Callout>

  - [students.txt](/module3/students_data.txt)
  - [departments.txt](/module3/departments_data.txt)
  - [courses.txt](/module3/courses_data.txt)
  - [grades.txt](/module3/grades_data.txt)

- ä½¿ç”¨ phpMyAdmin å¯¼å…¥æ•°æ®

    - æ‰“å¼€ phpMyAdminï¼Œé€‰æ‹©ä½ è¦å¯¼å…¥çš„è¡¨ï¼Œè¿™é‡Œç”±äºè€å¸ˆè¦æ±‚æˆ‘ä»¬ä½¿ç”¨å¤–é”®é“¾æ¥ï¼Œæ‰€ä»¥éœ€è¦æŒ‰ç…§é¡ºåºå¯¼å…¥ï¼Œ`students` -> `departments` -> `courses` -> `grades`
    ![é€‰æ‹©è¡¨](/module3/table.png)

    - é€‰æ‹©å®Œè¡¨åç‚¹å‡»ä¸Šæ–¹çš„import æŒ‰é’®
    ![å¯¼å…¥æŒ‰é’®](/module3/import.png)

    - ä¸Šä¼ æˆ‘æä¾›çš„å¯¹åº”çš„csvæ–‡ä»¶ï¼ŒFormat é€‰æ‹© `CSV`ï¼Œç„¶åç‚¹å‡» `Import` æŒ‰é’®
    ![ä¸Šä¼ æ–‡ä»¶](/module3/startimport.png)

### ç¬¬äº”æ­¥ï¼šæ’å…¥æ›´å¤šæ•°æ®

- æ’å…¥å­¦æ ¡çš„è¯¾ç¨‹ `CSE 330S`, `CSE 131`, å’Œ `CSE 260M`. è¿™é‡Œä½ å¯ä»¥æ€è€ƒä»¥ä¸‹å¦‚ä½•æ‰¾åˆ° `department code`. æˆ‘æŠŠsqlè¯­å¥æ”¾åœ¨ä¸‹é¢ï¼Œå¦‚æœå®åœ¨æƒ³ä¸å‡ºæ¥çš„è¯å†ä½¿ç”¨

```sql
SELECT school_code, dept_id, abbreviation, dept_name
FROM departments
WHERE abbreviation = 'CSE';
```

- æ’å…¥è€å¸ˆæä¾›çš„[è¿™äº›æ•°æ®](https://classes.engineering.wustl.edu/cse330/index.php/Module_3#Insert_More_Data)ï¼Œè€å¸ˆè¯´åˆ°çš„è¿™äº›æ•°æ®ä¸åœ¨ä¸€ä¸ªè¡¨å†…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å¯¹åº”çš„è¡¨é‡Œä½¿ç”¨æ’å…¥è¯­å¥ï¼Œè¿™é‡Œæœ‰å¤–é”®é™åˆ¶æ‰€ä»¥éœ€è¦æŒ‰é¡ºåºæ’å…¥å“¦~ è¿™é‡ŒåŒæ ·å»ºè®®å…ˆå°è¯•è‡ªå·±å†™ä¸€ä¸‹å†ä½¿ç”¨æˆ‘çš„sqlè¯­å¥ã€‚

    - æ’å…¥è¯¾ç¨‹æ•°æ®
    ```sql
    INSERT INTO course (school_code, dept_id, course_code, name)
    VALUES 
    ('E', '81', '330S', 'Rapid Prototype Development and Creative Programming'),
    ('E', '81', '131', 'Introduction to Computer Science'),
    ('E', '81', '260M', 'Introduction to Digital Logic and Computer Design');
    ```

    - æ’å…¥å­¦ç”Ÿæ•°æ®
    ```sql
    INSERT INTO students (id, first_name, last_name, email_address)
    VALUES 
    (88, 'Ben', 'Harper', 'bharper@ffym.com'),
    (202, 'Matt', 'Freeman', 'mfreeman@kickinbassist.net'),
    (115, 'Marc', 'Roberge', 'mroberge@ofarevolution.us');
    ```

    - æ’å…¥æˆç»©æ•°æ®
    ```sql
    INSERT INTO grades (student_id, grade, school_code, dept_id, course_code)
    VALUES 
    (88, 35.5, 'E', '81', '330S'),
    (88, 0, 'E', '81', '131'),
    (88, 95, 'E', '81', '260M'),
    (202, 100, 'E', '81', '330S'),
    (202, 90.5, 'E', '81', '131'),
    (202, 94.8, 'E', '81', '260M'),
    (115, 75, 'E', '81', '330S'),
    (115, 37, 'E', '81', '131'),
    (115, 45.5, 'E', '81', '260M');
    ```

### ç¬¬å…­æ­¥ï¼šæŸ¥è¯¢æ•°æ®

- è¿è¡Œ[ä»¥ä¸‹æŸ¥è¯¢](https://classes.engineering.wustl.edu/cse330/index.php/Module_3#Querying_Your_Database)ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ï¼ˆä¾‹å¦‚ query1.txtã€query2.txt ç­‰ï¼‰è¿™é‡Œæ€»å…±æœ‰äº”ä¸ªæŸ¥è¯¢ï¼Œæ‰€ä»¥æ€»å…±è¦æäº¤äº”ä¸ªtxtåˆ°ä½ çš„githubä»“åº“å“¦ï¼åŒæ ·çš„ï¼Œè¯·å…ˆè¯•è¯•å†ä½¿ç”¨æˆ‘éƒ½sqlè¯­å¥~

    - é€‰æ‹©æ•´ä¸ª grades è¡¨

    ```sql
    SELECT * FROM grades;
    ```

    - é€‰æ‹©æè¿° College of Arts & Sciencesï¼ˆå­¦æ ¡ä»£ç  Lï¼‰æä¾›çš„æ‰€æœ‰è¯¾ç¨‹çš„å­—æ®µ

    ```sql
    SELECT * FROM courses 
    WHERE school_code = 'L';
    ```

    - åˆ—å‡ºæ‰€æœ‰å­¦ç”Ÿçš„å§“åã€å­¦ç”Ÿ ID å’Œ CSE330 æˆç»©ï¼ˆæ¶‰åŠè¿æ¥ï¼‰

    ```sql
    SELECT students.first_name, students.last_name, grades.student_id, grades.grade
    FROM students
    JOIN grades ON students.id = grades.student_id
    WHERE grades.course_code = '330S';
    ```

    - åˆ—å‡ºå¹³å‡æˆç»©ä½äº 50 çš„å­¦ç”Ÿçš„å§“åã€ç”µå­é‚®ä»¶å’Œå¹³å‡æˆç»©ï¼ˆä½¿ç”¨èšåˆå‡½æ•°å’Œ HAVINGï¼‰

    ```sql
    SELECT students.first_name, students.last_name, students.email_address, AVG(grades.grade) AS average_grade
    FROM students
    JOIN grades ON students.id = grades.student_id
    GROUP BY students.id
    HAVING AVG(grades.grade) < 50;
    ```

    - ç”Ÿæˆ Jack Johnson çš„ä¸ªäººæŠ¥å‘Šå¡ï¼Œä»…æ˜¾ç¤ºä»–çš„å­¦ç”Ÿ IDã€ç”µå­é‚®ä»¶åœ°å€å’Œå¹³å‡æˆç»©ï¼ˆä½¿ç”¨è¿æ¥å’Œèšåˆå‡½æ•°)

    <Callout type="warning">
        è¿™é‡Œè¦æ³¨æ„æœç´¢è¦ç”¨åå­—è€Œä¸æ˜¯ `students.id`
    </Callout>

    ```sql
    SELECT students.id, students.email_address, AVG(grades.grade) AS average_grade
    FROM students
    JOIN grades ON students.id = grades.student_id
    WHERE students.first_name = 'Jack' AND students.last_name = 'Johnson'
    GROUP BY students.id;
    ```
</Steps>

## ä¸ªäººé¡¹ç›®è¯„åˆ†æ ‡å‡† (Grading)

### MySQL æŸ¥è¯¢ (MySQL Queries)- 25 åˆ†

- **MySQL æœåŠ¡å™¨è¿æ¥æˆªå›¾ï¼ˆ2 åˆ†ï¼‰**
   - åœ¨æ‚¨çš„å­˜å‚¨åº“ä¸­æ”¾å…¥è¿æ¥åˆ° MySQL æœåŠ¡å™¨çš„ç»ˆç«¯æˆªå›¾ã€‚

- **è¡¨å­—æ®µå’Œç»“æ„ï¼ˆ8 åˆ†ï¼‰**
   - ç¡®ä¿è¡¨çš„å­—æ®µï¼ŒåŒ…æ‹¬æ•°æ®ç±»å‹å’Œå¤–é”®ï¼Œéƒ½æ˜¯æ­£ç¡®çš„ã€‚
   - é€šè¿‡æäº¤åŒ…å« `SHOW CREATE TABLE` å‘½ä»¤è¾“å‡ºçš„æ–‡æœ¬æ–‡ä»¶æ¥æ¼”ç¤ºè¡¨çš„ç»“æ„ã€‚
   - æ¯ä¸ªè¡¨çš„æ–‡ä»¶åº”ä»¥ `tablename.sql` çš„å½¢å¼å‘½åï¼ˆä¾‹å¦‚ï¼Œ`students.sql`ï¼‰ã€‚

- **æŸ¥è¯¢è¾“å‡ºï¼ˆ15 åˆ†ï¼‰**
   - æ¯ä¸ªæŸ¥è¯¢çš„è¾“å‡ºéƒ½æ˜¯æ­£ç¡®çš„ï¼Œæ¯ä¸ªæŸ¥è¯¢å€¼ 3 åˆ†ã€‚
   - é€šè¿‡æäº¤åŒ…å«æŸ¥è¯¢çš„å®Œæ•´ç»“æœï¼ˆåŒ…æ‹¬æŸ¥è¯¢åŠè®°å½•æ•°ï¼‰æ¥æ¼”ç¤ºæŸ¥è¯¢çš„è¾“å‡ºã€‚
   - æŸ¥è¯¢ 1 çš„æ–‡ä»¶åº”å‘½åä¸º `query1.txt`ï¼ŒæŸ¥è¯¢ 2 çš„æ–‡ä»¶åº”å‘½åä¸º `query2.txt`ï¼Œä»¥æ­¤ç±»æ¨ã€‚

<Callout type="warning">
  è¯·ç¡®ä¿åœ¨ä½œä¸šæˆªæ­¢æ—¶é—´å‰å°†ä»£ç æäº¤åˆ° GitHubã€‚å°½æ—©å¹¶é¢‘ç¹æäº¤ä»£ç , ä¸ç„¶å¯èƒ½å¯¼è‡´è¯„åˆ†ä¸º0ã€‚
</Callout>

## å¤šäººéƒ¨åˆ† (Group Tasks)

<Callout type="warning">
  è¿˜åœ¨å¼€å‘ä¸­è¯·ç¨ç­‰ğŸ¥°~
</Callout>